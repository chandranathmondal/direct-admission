version: '3.8'
services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        REACT_APP_INITIAL_ADMIN_EMAIL: "${REACT_APP_INITIAL_ADMIN_EMAIL}"
        REACT_APP_GOOGLE_CLIENT_ID: "${REACT_APP_GOOGLE_CLIENT_ID}"
    image: direct-admission:local
    ports:
      - "${PORT}:${PORT}"
    restart: unless-stopped
    environment:
      GEMINI_API_KEY: "${GEMINI_API_KEY}"
      GOOGLE_SHEET_ID: "${GOOGLE_SHEET_ID}"
      GOOGLE_SERVICE_ACCOUNT_EMAIL: "${GOOGLE_SERVICE_ACCOUNT_EMAIL}"
      GOOGLE_PRIVATE_KEY: "${GOOGLE_PRIVATE_KEY}"
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8080/ || exit 1"]
      interval: 30s
      timeout: 5s
      retries: 3